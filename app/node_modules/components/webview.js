import React, { Component } from 'react';
import {
  WebView, View, Text, BackAndroid
} from 'react-native';
import Styles from 'styles'

export default class Webview extends Component {
  constructor(props){
    super(props);
    BackAndroid.addEventListener('hardwareBackPress', this.onBack);
  }

  componentWillUnmount(){
    BackAndroid.removeEventListener('hardwareBackPress', this.onBack);
  }

  render(){
    return (
      <WebView
        ref='webView'
        source={{uri: this.props.uri}}
        style={this.props.style}
        startInLoadingState={true}
        onNavigationStateChange={this.onNavigationStateChange}
      />
    )
  }

  onNavigationStateChange = (state) => {
    this.setState({
      canGoBack: state.canGoBack
    })
  };

  onBack = () => {
    if (this.state.canGoBack){
      this.refs.webView.goBack();
      return true;
    }else{
      if (this.props.callBack){
        this.props.callBack();
        return true
      }
    }
  }
}